<!--
author:   Daniel Nutting

version:  0.0.01

language: en

narrator: US English Female

comment:  Pen Testing Course for Florida Southern College
-->

# Penetration Testing

Foundations to Penetration Testing

# Orientation

What is the objective?
Fastest path to compromise?
Information Disclosure?
Realizing Risk?

## Course Ethics

## CIA Triad

Confidentiality
Integrity
Availability

Trust

## Notetaking

Information collected
Actions performed
Note taking goals:
  - Distinguish between the pen tester and a threat actor
  - Clean up
  - Evidence
  - Repeatability

Things to consider in note taking.

Screenshots

Timestamps

## Scoping

IP ranges
Servernames
Applications

Trust but verify

Secrecy

Impact

Define out of scope (e.g. don't touch the OT network)

## Objectives, Strategy, and Tactics

Time is a valuable, limited resource.

Goal orienting

Parallelization, Dependencies, Task Flows

Organization

Hail Marys

Rabbit Holes

Let the goal of the Pen Test address how you prioritize your time.

## Operating in Obscurity

Mental Model:

- Known

  - How discovered
  - Last verified

- Unknown (i.e. Need to Learn)

  - Testing Options
  - Dependencies

A penetration test involves continuously interating through defining unknowns, and identifying paths to make them known.

``` ascii
+-----------+               +---------+
|  Unknown  |---> Tool ---> |  Known  |
+-----------+               +---------+
```

Things that can change knowns:

- The client themselves.

  - Power down
  - Weekend and holiday
  - Customer impact
  - Approved changes, new deployments
  - Patching

- Other threat actors

  - Fight for dominance
  - Drive by exploitation

- You

  - Accidental impact
  - Network exhaustion
  - Shutting down systems
  - Getting caught

## Penetration Testing vs Red Teaming

## Test Phases and Structure

# Information Gathering

Often the first step in a penetration test is focused on gathering information. Consider the mental model we're using. Identifying unknowns and then selecting tools to convert them to knowns.

``` ascii
+-----------+               +---------+
|  Unknown  |---> Tool ---> |  Known  |
+-----------+               +---------+
```

Let's exemplify this with a simplified penetration test. Imagine we are assessing the security of a single web server. Based on the scope from the client we likely know:

- Domain Name
- IP address

Now consider all the things we do NOT know:

- Web server software
- Host operating system
- Plugins
- Usernames and passwords
- Server administrators
- Email addresses
- Open ports
- Cohosted applications
- Backend database connections
- Network and Web Application Firewalls
  
  ... The list goes on

Each of these elements could potentially lead further along the path to compromise.

In order to answer these questions, we need to employ various techniques that allow us to discover this information both *passively* and *actively*.

## Passive vs Active

Passive Reconnaissance
======================
**Passive Reconnaissance** is when we collect information about the target ~~without~~ engaging the target in any way. The nature of the internet causes people and organizations to leave bread crumbs of information scattered around. Some of that information is intentional. The internet was built to allow people to *find* information after all. Examples of passive reconnaissance include searching for LinkedIn profiles, news articles, or querying the domain registrar for information. In the last example, this is considered passive because the query is done against a third party, not the client. Some passive reconnaissance may collect stale or expired information.

Active Reconnaissance
=====================
**Active Reconnaissance** is when we collect information about the target by ~~stimulating~~ a response. During active reconnaissance, our scans are interacting with the client's infrastructure and soliciting a response. Examples of active reconnaissance include port scanning, vulnerability scanning, and user account bruteforcing. Active reconnaissance is unlikely to collect stale information. However, a savvy organization may seed deceptive information intentionally to thwart our approach.

Covert Reconnaissance
=====================
**Covert Reconnaissance** is a blend between the two. Most organizations on the internet want to interact with others, especially customers. As such, there is a standard collection of behaviors that should be seen as normal by any monitoring system. Examples of covert reconnaissance would be browsing web pages just like a customer would. At least as far as it appears to the web server.  We may be fiendishly taking notes and saving pcaps while doing so. But, as long as it presents just like a normal user, the target should be none the wiser.

Generally penetration testing literature only discusses Passive and Active, with disagreements as to where mimicking standard users belongs. To address this, we're identifying it as a third type.

A last type of reconnaissance may include a **Watering Hole**, where we, as an attacker, set up infrastructure and allow the target to engage with it on their own. This is generally uncommon, but can be a component of an overall attack.
  
## Storytelling

While engaging with a penetration test there are two general stories or narratives that are unfurling. The first is the one we are discovering and learning about the target organization. As we saw in our first exposure with the "Broken" web machine, the web page was down for maintenance and the administrator was testing new Content Management Systems (CMS). It appears the administrator found a free CMS online and did not review the code. We discovered that in our information gathering to gain a foothold onto the server.

The second narrative involves the role or roles we take on as we compromise different user accounts. When conducting a test, our interactions will leave evidence behind. We want to be congnizant of how our interactions will impact the infrastructure, and whether the traces of our behavior look legitimate.

At this stage, let's focus on the first narrative, that of the defending organization.

Within this narrative there is a setting, the organizational infrastructure, and there are actors, the users and administrators of the system. *Both the infrastructure and the users will have vulnerabilities to exploit.* During our first iteration of information gathering, we will typically follow a structured, methodical approach to identify and understand the setting and actors which are public facing. This is collection of information is known as the attack surface.

<!-- style="display:none" -->
<div style="display:none">
Author's note: Consider expanding around:
- Interacting with the target. 

  -- Mimic customer? 
  -- Mimic Vendor? 
  -- Behave differently?

Infrastructure, Assets, and Personnel
</div>

## Attack Surface

The victim's attack surface is all of the public facing interfaces through which we can deploy our initial capabilities. The attack surface includes things like routers, web servers, firewalls, vpn terminations, file shares, and even email addresses. In other words, the attack surface is the collection of destinations to which nefarious data can be sent.

The attack surface can also be considered in a more nuanced approach. For instance, a web application will have an attack surface made up of the API endpoints, user accounts, code pipeline, and web admin email addresses.

Both attackers and defenders regularly assess attack surfaces. For defenders, reducing the attack surface narrows the entry points for attackers to breach an organization. For attackers, understanding the attack surface orients their intial plan of attack.

https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html

## Diamond Model

In the Detection Engineering class, we discussed the [Diamond Model](https://www.threatintel.academy/wp-content/uploads/2020/07/diamond-model.pdf) for mapping threat intelligence. This is used by defenders to understand the adversary and how they are likely to interact with the victim organization.

``` ASCII
               Adversary
                  /\
                 /  \
                /    \
Infrastructure +------+ Capability
                \    /
                 \  /
                  \/
                Victim
```

To summarize, the Diamond Model describes the Adversary, **their** infrastructure, **their** capabilities, and how those can be deployed against the victim. In the Diamond Model documentation, the victim is defined as follows:

> A *victim* is the target of the adversary and against whom vulnerabilities and exposures are exploited and capabilities used.
> 
> Victim Personae are the people and organizations being targeted whose assets are being exploited and attacked.
> 
> Victim Assets are the ~~attack surface~~ and consist of the set of networks, systems, hosts, email addresses, IP addresses, social networking accounts, etc. against which the adversary directs their capabilities.
>
> -- The Diamond Model of Intrusion Analysis; Caltagirone, Pendergrast, and Betz

*Inverted* Diamond Model
========================

In our course, we're going to leverage a similar style of thinking, but now with a focus on the Victim. This means, in our information gathering, we want to collect information about the victim's assets and personae, so that we can select appropriate capabilities for our attacks.

``` ASCII
        Victim
          /\
         /  \
        /    \
Assets +------+ Personae
        \    /
         \  /
          \/
   Attack Capability
```

After practice and gathering experience, we will develop an inventory of capabilities that we can quickly leverage againt the victim. And as we deploy those capabilities we will continuously learn more and more about the victim.

## Open Source Intelligence (OSINT)

The term OSINT is a fancy way of saying, it was easily accessible on the internet. In general, "open source" is *free to read*. The term comes from open source software, where the underlying source code was open to public scrutiny.

Open Source Intelligence is thus free to read. In practice there are some resources that ask for money for amplified data. Often times these sites make searching and curating open source data practical, where doing so on our own is not.

We've all received the random phone number, which did not leave a voice mail. I'm sure we've all also typed the phone number in Google to find information about it. This is a prime example of executing OSINT in our daily lives.

The [OSINT Framework](https://osintframework.com/)[^1] is a website that inventories many, many different sources and tools for collecting information from online sources. This can be used to ideate and align to online repositories. For instance, if we wanted to review Business Records about our topic, we can navigate through the OSINT framework -> Annual Reports -> Public Register Online website. 
Or, perhaps we want to see if there are any publicly accessible webcams in the area. So we'd navigate Images / Videos / Docs -> Webcams -> Insecam.

This list, just like any attempting to inventory things on the internet, is incomplete. We will find other OSINT tools and resources. Moreover, this list will eventually become stale as the maintainer loses interest or attention to their project.

[^1]: As of writing this, this website is randomly throwing SSL handshake errors. A couple of refreshes eventually allows for a good connection.

### Infrastructure

The first actionable step in our information gathering journey starts with the victim's infrastructure. Here we want to collect information about the servers, software, domains, and the other supporting elements. The OSINT Framework only lists Domain Name and IP & MAC Address. While there is plenty more infrastructure to info gather about, other aspects such as software, may require *active* instead of passive techniques.

#### Domain Intelligence

The internet's Domain Name System obligates organizations to describe themselves when registering their domain. And registering a domain allows customers to easily navigate to their website, instead of needing to memorize IP addresses.[^1] Registering a domain involves two primary steps. First, an organization registers with a Name Registrar. This is an authoritative entity that is allowed to dole out exclusive and unique domains. 

[^1]: Fewer and fewer websites are navigable with only an IP address. Many web servers actually share a single IP address, and intelligence application management recognizes which website the user wants based on the domain being requested. Additionally, since normal humans don't normally surf the web using IP addresses, many web servers are configured to just reject requests that do not use domains. [ICANN](https://www.icann.org/en/accredited-registrars) manages a list of accredited registrars who are permitted to do this for generic top level domains ([gTLDs](https://icannwiki.org/Generic_top-level_domain)). These registrars collect information about the organization, including a named representative, mailing address, and contact information, and most importantly, the authoritative *Name Servers*. This information is then added to the ICANN registry.

Name Servers are responsible for servicing detailed information about the domain, particularly which IP addresses are associated with the domain.

##### WHOIS

Whois Command
=============

Pretty much every Domain Registrar provides a whois interface for examining this registration information. And generally, we could query the information for a domain from any registrar, even if they did not originally register the domain. This can be done in the Kali command line interface using the `whois` command. Or often directly on a registrar's webiste.

Whois tools search for objects in an [RFC 3912](https://www.rfc-editor.org/rfc/rfc3912) database. Whois servers typically listen on TCP port 43 for requests. the `whois` command will manage that for us.

-----

In Kali, execute the following:

`whois flsouthern.edu`

When was the domain record activated?

[( )] 01-Jan-1990
[(x)] 07-Mar-1996
[( )] 10-Oct-2002
[( )] 03-Jun-2024
[[?]] **Not** when the record expires or is last updated.

-----

Online Whois Tools
==================

Many registrars have an online whois tool as well.

1) Navigate to [whois.com](https://www.whois.com/whois/).

2) Execute a whois using whois.com for the domain `flsouthern.edu`. What is the authoritative whois database for this domain?

    [[EDUCAUSE]]
    [[?]] The name of the database is in all caps.
    [[?]] The authoritative database is identified in the preamble of the response.

3) What is the name of the third name server supporting flsouthern.edu?

    [[NS3-01.AZURE-DNS.ORG]]

Consider whether interacting with one of the nameservers could leak information back to flsouthern during a pen test.

4) Who is the technical contact?

    [[Jean Whitehead]]
    [[?]] Firstname Lastname

5) What is the technical contact's email address?

    [[jwhitehead@flsouthern.edu]]

Compare the email addresses in the WHOIS results to the user's actual names. Consider what this tells us about potential username structures.

-----

IP Address WHOIS
================

Whois tools can also be used to assess IP addresses registered to an internet resource.

Use the `nslookup` tool to identify the IP address associated with flsouthern.edu.
Execute a `whois` against this IP address.

6) What is the OrgName?

    [[Microsoft Corporation]]
    [[?]] `nslookup flsouthern.edu`
    [[?]] `whois 20.40.202.27`

<!-- style="display:none" -->
<div style="display:none">
Execute a whois against publix.com.

What is the Registrar URL?

    [[www.cscprotectsbrands.com]]

What is the Registrant Name?

    [[Pat Caruso]]

Compare the whois results between the web tools and the Kali command line.
</div>

##### Domain Name Lookups

Once a domain name is registered and established, Name Servers communicate on the internet to provide details about that domain. DNS servers listen on UDP port 53 for queries about a domain. If they know the answer the respond back with the information.

DIG
===

Dig is a particularly powerful command-line tool for executing DNS queries. Use of the dig command looks like this:

`dig @server name type`

`@server` tells the command which dns server to make the query to. `name` identifies the domain name we want to query for. `type` identifies the type of record we want.  By default, dig looks for 'A' records, which are the primary records that say which IP address is hosting the requested domain.

During the information gathering phase, we want to gather any and all domain records available. This can sometimes be done with the `ANY` parameter.

-----

1) Execute the following:

`dig flsouthern.edu`

What IP address is given in the answer section?

  [[20.40.202.27]]

-----

2) Execute the following and consider the lack[^1] of valuable results:

`dig flsouthern.edu any`

[^1]: If executing this on campus, this may see a result, because you are likely querying against FLSouthern's actual DNS servers.

-----

3) Execute the following to identify the "Start of Authority"

`dig flsouthern.edu soa`

What is the SOA? Compare to the results from the WHOIS lookups.

  [[ns1-01.azure-dns.com]]

-----

4) Execute the following and compare to the results from our previous attempt to use 'any':

`dig flsouthern.edu @ns1-01.azure-dns.com any`

What answer are we getting now? (The answer is listed in quotes)

  [[RFC8482]]
  [[?]] The answer starts with RFC.

What does this mean? Read the [Request For Comment](https://www.rfc-editor.org/rfc/rfc8482) for more information.

##### DNS Record Types

Since the ANY query type isn't reliable, we may need to explicitly query against each type of record to find results. This table lists some of the more commonly useful DNS records for information gathering. Other DNS record types can be found [here](https://en.wikipedia.org/wiki/List_of_DNS_record_types).

| Record Type | Description                                                                              |
| ----------- | ---------------------------------------------------------------------------------------- |
| A           | IPv4 address                                                                             |
| AAAA        | IPv6 address                                                                             |
| AFXR        | [Zone Transfer Request](https://www.acunetix.com/blog/articles/dns-zone-transfers-axfr/) | 
| CNAME       | Canonical Name Record                                                                    |
| DNAME       | Delegation Name Record                                                                   |
| HINFO       | Provides the minimalized responses to ANY queries                                        |
| LOC         | Geographic location associated with a domain name                                        |
| MX          | List of mail exchange servers that accept email for the domain                           |
| NS          | Name Server record, delegates a DNS zone to use specified server                         |
| PTR         | Pointer to a canonical name                                                              |
| RP          | Information about a responsible person for the domain                                    |
| SOA         | Start of Authority, specifies authoritative information about a DNS zone.                |
| TXT         | Originally meant for human readable comments, now used for a variety of things.          |

MX Records
==========

MX Records are used to communicate where emails should be delivered to.

What domain receives emails intended for @flsouthen.edu?

  [[barracudanetworks.com]]
  [[?]] Do a dig for an mx record.
  [[?]] `dig mx flsouthern.edu`

TXT Records
===========

Text records hold a plethora of information. The flexibility of the TXT records allows them to be used for various features such as encryption information, proving the owner of the domain actually *owns* the domain, and designating what servers are allowed to send email on behalf of the organizations domain.

A very common TXT record is a [Sender Policy Framework](https://en.wikipedia.org/wiki/Sender_Policy_Framework) (SPF) record. It lists domains and IPs that may be used to send on behalf of the domain.

What IP address, starting with 3.214, is permitted to send email as though they are coming from FLSouthern.edu?

  [[3.214.204.181]]
  [[?]] Do a dig for a TXT record.
  [[?]] Look for the entry that starts with v=spf1

What organization owns the IP address 44.211.178.112?

  [[Amazon]]
  [[?]] Do a nslookup against the IP address

If we were able to spin up a virtual machine in EC2, and happen to get one of the 16 IP addresses aligned to 44.211.178.112/28, **we would be able to send emails spoofing @flsouthern.edu.**

AXFR (Zone Transfer)
====================

This is not a record, but rather the invocation of the [AXFR protocol](https://networkencyclopedia.com/zone-transfer/) to copy all of the details about the dns zone. The intent is to be able to easily replicate information about a domain from one name server to another, for redundancy purposes. As you can imagine, this can provide A LOT of information about a domain, so zone transfers are normally blocked, but not always.
Legitimate zone transfers should be rare, and should only occur from known IP addresses. Therefore is may be safer to assume that attempts to zone transfer a domain could trigger an alert to the monitoring team.

Run the following command to identify one of the nameservers for the zonetransfer.me domain:
`dig +short ns zonetransfer.me`

Now initiate a zone transfer using the "axfr" type. Make sure to declare the specific name server.
`dig axfr zonetransfer.me @nsztm1.digi.ninja.`

Compare the results to making a request for ANY record
`dig ANY zonetransfer.me @nsztm1.digi.ninja.`

##### Kali tools

While I do NOT consider these passive reconnaissance tools these are worth talking about in context with DNS.

DNSEnum
=======

[Dnsenum](https://www.kali.org/tools/dnsenum/) packages a lot of the dns enumeration into a single command invocation. It grabs the A records, nameservers, MX records, and attempts to perform Zone transfers on each name server. It also attempts to bruteforce guess subdomains, and even run a google query to find additional subdomains!

Review the man page for `dnsenum`. 

>  Is there a parameter to tell the tool to skip zone transfers?
>
>    [( )] Yes
>    [(x)] No
>    [[?]] `man dnsenum`

> What list is used by default for bruteforcing subdomains? Include the full path.
> 
>   [[/usr/share/dnsenum/dns.txt]]
>   [[?]] Read the note at the beginning of the help file.
>   [[?]] `dnsenum -h`
>   [[?]] Starts with `/usr/share`.

Execute a `dnsenum` against `zonetransfer.me`. Consider how long this tool takes without customizing the parameters.

-----

DNSMap
======

While `dnsenum` does a lot of things in a single tool, sometimes it's better to focus on one thing. [Dnsmap](https://www.kali.org/tools/dnsmap/) let's us attempt to enumerate subdomains with a wordlist. Similar to the previous tool, `dnsmap` also has it's own default wordlist. The internal wordlist is built into it's sourcecode, but Kali has plenty of wordlists we can use as well.

Scan `example.com` with `dnsmap`.

Examine the wordlist at `/usr/share/wordlists/dnsmap.txt`.

Use this wordlist to scan `example.com`. Consider again how long this tool takes without customizing the parameters. You may want to let this run while you continue reading.

DNSRecon
========

Yet another tool that does similar work. `Dnsrecon` is highly configurable, and can search for subdomains using several search engines like Yandex, Bing, and CRT.sh.

> Note: [dnsrecon](https://www.kali.org/tools/dnsrecon/)'s page on kali.org has a mistake in the example usage. A wordlist is not used during a standard enumeration.
>
>   What enumeration type would we use if we wanted to use a wordlist?
>
>     [[brt]]
>     [[?]] Examine the full list of enumeration types in the manual.

Fierce
======

Lastly, a fourth tool. What distinguishes [fierce](https://www.kali.org/tools/fierce/) from the other tools is that it will scan for IP neighbors. The assumption is that an organization often has a neighborhood of IP addresses. When fierce resolves a domain query to an IP, it will attempt reverse lookups of other adjacent IPs to see what those results are.
This has a tendency of finding unrelated infrastructure. Not all organizations have a contiguous range of IPs any longer, especially if they are operating in the cloud.


##### Online Tools

Domain Dossier
==============

One of the perks of using online tools is that information requested comes from a third party entity, further obfuscating our efforts. Unlike running `dig` or `dnsenum`, which stimulate dns queries from our attack platform, these tools run on their own servers, and report the data back to us.

My preferred tool to examine WHOIS and Domain Registration information is CentralOps.net's [Domain Dossier](https://centralops.net/co/).
If we search flsouthern.edu against the Domain Dossier, we'll find an A record, several NS records, and two HINFO records. Note the lack of MX and TXT records. Compare this to the results we can see with a search against nyt.com. This highlights a key mis-step many novice pentesters make.

> **Common Error**: A lack of a result does NOT mean a lack of existence.

Very often, practitioners will come to trust their preferred tools too much. They may start to assume that if the tool did not show a certain result, the result must not exist. As we can see here, this is clearly a falacy.

MXToolbox
=========

Another tool I find quite useful is [MXToolbox](mxtoolbox.com). It's meant for analyzing MX records, but it can also analyze other DNS records as well.

1) Using MXToolbox, do a query against flsouthern.edu.

2) After getting the initial results, click the orange dropdown next to MX Lookup to look at the other options.

3) Run an SPF Record lookup and compare the results to what we've seen previously.

Much easier to read these results, isn't it!?

##### Private Registration

Navigate back to the Domain Dossier tool, and run a query for cyberfortress.org.  What information can we find about the owner of the domain? Not much, right? It is VERY common these days for domains to have private registration so that the owners do not leak information out to pen testers like us (and spammers).

This brings us to another tool, BigDomainData.com, which maintains a freely accessible [WHOIS History](https://www.bigdomaindata.com/whois-history/) tool.

Execute a WHOIS History lookup for cyberfortress.org.

#### Network Intelligence

##### IP Addresses

Similar to domain registrations, public IP addresses are, often, unique to a specific organization. Ranges of IPs are assigned to Internet Service Providers who will further assign their IPs to businesses or residents.

For the most part, in the United States, individuals and organizations are still getting unique IPv4 addresses. IPv6 adoption is still lagging, and much of that is due to *very* effective mitigations with Network Address Translation and Subnetting.

Thanks to this, we can mine significant information about an organization just based on their IP registration.

ARIN and Other Regional IP Registrars
=====================================

The [American Registry for Internet Numbers](https://www.arin.net) is the authoritative source for IP assignments in North America. Other geographic areas will have their own version of ARIN, such as AFRINIC for Africa, LACNIC for Latin America, APNIC for Asia Pacific, and RIPE NCC for Europe and Middle east. Similar to how domain registration is shared and communicated across name registrars, the various IP assignment authorities also maintain shared repositories, so searches against one organization should return similar, if not the same results.

ARIN maintains their own type of WHOIS, allowing individuals to discern organizational information about any IP address with a simple query.

WhoWas
======

Similar to the domain WHOIS history, IP history can be procured from ARIN's [WhoWas](https://www.arin.net/reference/research/whowas/) tool.

Exercises
=========

> Navigate to [https://search.arin.net/](https://search.arin.net/) and search for `172.99.58.62`. This happens to be the IP address I show as my Public address while on campus.
> 
>  What is the organization associated with this IP according to ARIN?
>
>    [[Frontier Communications Corporation]]
>
> Now grab the IP address from `flsouthern.edu`'s A Record, and look that up in ARIN.
>
>  What organization is associated with `flsouthern.edu`'s IP address in the A record?
>
>    [[Microsoft Corporation]]
>    [[?]] `dig a flsouthern.edu` will give you the A record
>    [[?]] The dig command should give you a result similar to 20.40.202.27.
>    [[?]] Run the ARIN search on 20.40.202.27.

> Review the ARIN results [here](https://search.arin.net/rdap/?query=64.70.56.99).
>
>   Based on the ARIN report, do you believe we've identified the true organization behind 64.70.56.99?
>
>    [( )] Yes
>    [(x)] No
>    [[?]] Who is Cox Communications? What service do they provide?
>
> Do a reverse DNS lookup on the IP.
>
>   What domain comes up with a reverse DNS lookup?
>
>    [[www.dealer.com]]
>    [[?]] Check the manual for the `dig` command to see how to trigger a reverse lookup.
>    [[?]] `man dig` to open the manual.
>    [[?]] While in the manual, press `/` key to initate search mode, and search for "reverse".
>    [[?]] dig -x 64.70.56.99
>
> Navigate to the domain you found in the previous step. Who is Cox automotive?
>
> Examine the A record for bmwofwestlake.com.
>
> Compare to the A record for jenkinshyundaiofocala.com

###### Cached DNS

We can see in the previous exercise that reverse DNS lookups do not necessarily give us comprehensive information regarding which domains are behind an IP address. This is one of the "features" of DNS. *Any domain* can point to an IP address.

Reverse DNS queries search for PTR records, which store IP addresses and *point* to a domain. PTR records are structured with the IP address written in reverse, and then concatenated with the string ".in-addr.arpa"

> Look at the Question section of your `dig -x 64.70.56.99` command. 
> Your command initiated a DNS Question for a PTR record containing `99.56.70.64.in-addr.arpa`. 
> In the Answer section, the DNS server responded with a PTR record listing `www.dealer.com`.

So, unless there is a PTR record for EVERY website hosted by a web server, reverse lookups are not going to show us all of the information. This is where we need to leverage OSINT services that capture DNS queries and build their own databases.

[ViewDNS.info](https://viewdns.info) has a large number of tools we can use, including a Reverse IP lookup.

> Use ViewDNS.info, and run a reverse IP lookup for `64.70.56.99`.
> Scan through the domains associated with this IP. You should see a clear trend of vehicle dealerships
>
> Do a reverse lookup using `dig` for `23.281.6.253`.
>
>   What host is the PTR record pointing to?
>
>    [[a23-218-6-253.deploy.static.akamaitechnologies.com.]]
>    [[?]] The host is the right side of the PTR record in the Answer section.
>
> Use the ViewDNS tool, and conduct a Reverse IP Lookup.
>
>   What Domain is associated with that IP?
>   
>    [[publix.com]]

##### MaxMind

Ever notice while browsing the web, you get advertising targeting your local area? And for those of you who use VPNs, you may notice how those advertisements change. This is because the advertisement networks are making **assumptions** about your geographic location based on the public IP address.

MaxMind is largerly considered the best resource for extracting geographic insight from an IP address. MaxMind collects this data from a variety of sources including ARIN IP registrations and collecting data directly from ISPs.

Exercises
=========

1) Identify your own Public IP address. A fun website to do this with is [icanhazip.com](https://www.icanhazip.com).

2) Navigate to the [MaxMind demo](https://www.maxmind.com/en/geoip-demo), and search against your IP. You'll need to scroll down a bit to see where you can submit the IP address.

3) Review the results. Copy and paste the Latitude and Longitude into Google Maps. How accurate is it?

4) Conduct a MaxMind lookup for the IP address `198.81.128.5`. Based on the Latitude and Longitude, what organization does this appear to belong to?

  [[Potomac Falls High School]]
  [[?]] Drop the Lat/Lon from Max Mind into Google Maps

5) Conduct an ARIN lookup on the IP address. What is the name of the Organization?

  [[Central Intelligence Agency]]
  [[?]] https://search.arin.net/rdap/?query=198.81.129.68

#### Job Postings (Move this later)

#### Social Information and Context (Move this later)

Search Engines

Wayback Machine

SaaS Publishing (GitHub, WordPress)

Vendors and "Logos"

#### Personnel

##### Social Media

LinkedIn
Conference Sponsorship

##### Email Mining

##### Password Reuse

### Stimulated OSINT

Third party scanning services

MXtoolbox
Security Headers
Domaintools
UrlScan

### Social Engineering and Phishing

#### Domain Typo Squatting

### Active Data Collection

### Risks and Mitigations

## Wateringhole

# Enumerating Access Options

# Beachhead

# Internal Reconnaissance

# Orienteering

# Report Writing

You can use common [Markdown](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet) syntax to create your course, such as:

1. Lists
2. ordered or

   * unordered
   * ones ...


| Header 1   | Header 2   |
| :--------- | :--------- |
| Item 1     | Item 2     |


Images:

![images](https://farm2.static.flickr.com/1618/26701766821_7bea494826.jpg)


### Extensions

     --{{0}}--
But you can also include other features such as spoken text.

      --{{1}}--
Insert any kind of audio file:

       {{1}}
?[audio](https://bigsoundbank.com/UPLOAD/mp3/1068.mp3)


     --{{2}}--
Even videos or change the language completely.

       {{2-3}}
!?[video](https://www.youtube.com/watch?v=bICfKRyKTwE)


      --{{3 Russian Female}}--
Первоначально создан в 2004 году Джоном Грубером (англ. John Gruber) и Аароном
Шварцем. Многие идеи языка были позаимствованы из существующих соглашений по
разметке текста в электронных письмах...


    {{3}}
Type "voice" to see a list of all available languages.


### Styling

<!-- class = "animated rollIn" style = "animation-delay: 2s; color: purple" -->
The whole text-block should appear in purple color and with a wobbling effect.
Which is a **bad** example, please use it with caution ...
~~ only this is red ;-) ~~ <!-- class = "animated infinite bounce" style = "color: red;" -->

## Charts

Use ASCII-Art to draw diagrams:

                                    Multiline
    1.9 |    DOTS
        |                 ***
      y |               *     *
      - | r r r r r r r*r r r r*r r r r r r r
      a |             *         *
      x |            *           *
      i | B B B B B * B B B B B B * B B B B B
      s |         *                 *
        | *  * *                       * *  *
     -1 +------------------------------------
        0              x-axis               1

## Quizzes

### A Textquiz

What did the **fish** say when he hit a **concrete wall**?

    [[dam]]

### Multiple Choice

Just add as many points as you wish:

    [[X]] Only the **X** marks the correct point.
    [[ ]] Empty ones are wrong.
    [[X]] ...

### Single Choice

Just add as many points as you wish:

    [( )] ...
    [(X)] <-- Only the **X** is allowed.
    [( )] ...


## Executable Code

You can make your code executable and define projects:

``` js     -EvalScript.js
let who = data.first_name + " " + data.last_name;

if(data.online) {
  who + " is online"; }
else {
  who + " is NOT online"; }
```
``` json    +Data.json
{
  "first_name" :  "Sammy",
  "last_name"  :  "Shark",
  "online"     :  true
}
```
<script>
  // insert the JSON dataset into the local variable data
  let data = @input(1);

  // eval the script that uses this dataset
  eval(`@input(0)`);
</script>


## More

Find out what you also can do ...

https://LiaScript.github.io/course/?https://raw.githubusercontent.com/liaScript/docs/master/README.md